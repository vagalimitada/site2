function UET(e){this.stringExists=function(e){return e&&e.length>0},this.domain="bat.bing.com",this.URLLENGTHLIMIT=4096,this.pageLoadEvt="pageLoad",this.customEvt="custom",this.pageViewEvt="page_view",e.Ver=void 0===e.Ver||"1"!==e.Ver&&1!==e.Ver?2:1,this.uetConfig={},this.uetConfig.consent={enabled:!1,adStorageAllowed:!0,adStorageUpdated:!1,hasWaited:!1,waitForUpdate:0},this.beaconParams={},this.supportsCORS=this.supportsXDR=!1,this.paramValidations={string_currency:{type:"regex",regex:/^[a-zA-Z]{3}$/,error:"{p} value must be ISO standard currency code"},number:{type:"num",digits:3,max:999999999999},integer:{type:"num",digits:0,max:999999999999},hct_los:{type:"num",digits:0,max:30},date:{type:"regex",regex:/^\d{4}-\d{2}-\d{2}$/,error:"{p} value must be in YYYY-MM-DD date format"},pid:{type:"pid"},enum:{type:"enum",error:"{p} value must be one of the allowed values"},array:{type:"array",error:"{p} must be an array with 1+ elements"},object:{type:"object",error:"{p} must be an object with 1+ elements"}},this.knownParams={event_action:{beacon:"ea"},event_category:{beacon:"ec"},event_label:{beacon:"el"},event_value:{type:"number",beacon:"ev"},page_title:{},page_location:{},page_path:{},ecomm_prodid:{beacon:"prodid"},ecomm_pagetype:{type:"enum",values:["home","searchresults","category","product","cart","purchase","other"],beacon:"pagetype"},ecomm_totalvalue:{type:"number"},ecomm_category:{},ecomm_query:{},ecomm_exp:{},hct_base_price:{type:"number"},hct_booking_xref:{},hct_checkin_date:{type:"date"},hct_checkout_date:{type:"date"},hct_length_of_stay:{type:"hct_los"},hct_partner_hotel_id:{},hct_total_price:{type:"number"},hct_pagetype:{type:"enum",values:["home","searchresults","offerdetail","conversionintent","conversion","property","cart","purchase","cancel","other"]},travel_destid:{},travel_originid:{},travel_pagetype:{type:"enum",values:["home","searchresults","offerdetail","conversionintent","conversion","cancel","other"]},travel_startdate:{type:"date"},travel_enddate:{type:"date"},travel_totalvalue:{type:"number"},flight_destid:{},flight_originid:{},flight_pagetype:{type:"enum",values:["home","searchresults","offerdetail","cart","purchase","cancel","other"]},flight_startdate:{type:"date"},flight_enddate:{type:"date"},flight_totalvalue:{type:"number"},affiliation:{},brs_response_id:{},checkout_option:{},checkout_step:{type:"integer"},content_id:{},content_type:{},coupon:{},currency:{type:"string_currency",beacon:"gc"},description:{},fatal:{},method:{},name:{},revenue_value:{type:"number",beacon:"gv"},screen_name:{},search_term:{},shipping:{type:"number"},tax:{type:"number"},transaction_id:{},rep:{},vid:{},tpp:{},gtm_tag_source:{},items:{type:"array"},"items.brand":{},"items.category":{},"items.creative_name":{},"items.creative_slot":{},"items.id":{},"items.list_name":{},"items.list_position":{type:"integer"},"items.location_id":{},"items.name":{},"items.price":{type:"number"},"items.quantity":{type:"number"},"items.variant":{},promotions:{type:"array"},"promotions.creative_name":{},"promotions.creative_slot":{},"promotions.id":{},"promotions.name":{},pid:{type:"object"},"pid.em":{type:"pid"},"pid.email":{type:"pid",beacon:"em"},"pid.ph":{type:"pid"},"pid.phone_number":{type:"pid",beacon:"ph"}},this.knownEvents={add_payment_info:[],add_to_cart:["revenue_value","currency","items"],add_to_wishlist:["revenue_value","currency","items"],begin_checkout:["revenue_value","currency","items","coupon"],checkout_progress:["revenue_value","currency","items","coupon","checkout_step","checkout_option"],exception:["description","fatal"],generate_lead:["revenue_value","currency","transaction_id"],login:["method"],page_view:["page_title","page_location","page_path","rep","tpp","gtm_tag_source","pid"],purchase:["transaction_id","revenue_value","currency","tax","shipping","items","coupon"],refund:["transaction_id","revenue_value","currency","tax","shipping","items"],remove_from_cart:["revenue_value","currency","items"],screen_view:["screen_name"],search:["search_term"],select_content:["items","promotions","content_type","content_id"],set_checkout_option:["checkout_step","checkout_option"],share:["method","content_type","content_id"],sign_up:["method"],view_item:["items"],view_item_list:["items"],view_promotion:["promotions"],view_search_results:["search_term"]},this.pageLevelParams={},this.legacyValidPageLoadKeyNames={rep:1,pid:1},this.legacyValidCustomEventKeyNames={ec:1,el:1,ev:1,ea:1,gv:1,gc:1,prodid:1,pagetype:1},this.ambiguousValidCustomEventKeyNames={ecomm_prodid:1,ecomm_pagetype:1,rep:1},this.validRetailPageTypeValues={home:1,searchresults:1,category:1,product:1,cart:1,purchase:1,other:1},this.invalidKeyException="Invalid data: Key Name: ",this.invalidEventException="Invalid event type: Event Type: ",this.invalidPageTypeException="Invalid pagetype value: ",this.invalidProdIdException="The prodid value must be within 1 to 50 characters.",this.missingPageTypeException="The pagetype parameter is required when you include the prodid parameter.",this.goalCurrencyFormatException="gc value must be ISO standard currency code",this.missingHotelParametersException="The hotel total price (hct_total_price) and currency parameters are required when you include other hotel parameters.",this.hotelVariableRevenueException="The variable revenue parameter (revenue_value) cannot be sent when you include other hotel parameters.",this.evq=e.q instanceof Array?e.q:[],this.evqDispatch=!1,this.pageLoadDispatch=!1,this.documentLoaded=!1,this.deferLoad=!1,this.eventPushQueue=[],this.uetInstance=this,this.domainName=null,this.sessionCookieName="_uetsid",this.sessionExpirationTime=86400,this.visitorExpirationTime=33696e3,this.cookieIdMaxLength=36,this.msClkIdCookieValuePrefix="_uet",this.msClkIdCookieName="_uetmsclkid",this.msClkIdParamName="msclkid",this.msClkIdExpirationTime=7776e3,this.lengthMsClkId=32,this.msClkId=null,this.subVersion=1,this.previousPage=null,this.snippetEventQueue=[],this.checkuetHostdocumentload=function(){var e,t=this.uetInstance;if(t.documentLoaded=!(!document.body||document.readyState&&"interactive"!==document.readyState&&"complete"!==document.readyState&&"loaded"!==document.readyState||t.deferLoad),t.documentLoaded){if(t.uetConfig.consent.enabled&&!t.uetConfig.consent.hasWaited&&t.uetConfig.consent.waitForUpdate>0)t.uetConfig.consent.hasWaited=!0,setTimeout((function(){t.checkuetHostdocumentload()}),t.uetConfig.consent.waitForUpdate);else if(t.eventPushQueue.length>0){for(e=0;e<t.eventPushQueue.length;e++)t._push(t.eventPushQueue[e]);t.eventPushQueue=[]}}else setTimeout((function(){t.checkuetHostdocumentload()}),5)},this.trimTagId=function(e){1!==e.Ver&&(this.stringExists(e.tagId)&&!this.stringExists(e.ti)&&(e.ti=e.tagId),this.stringExists(e.ti)&&(e.ti=e.ti.replace(/^\s+|\s+$/g,"")))},this.isDuplicate=function(e){try{return!(!e||!e.q||"object"!=typeof e.q)&&(!(2!==e.Ver||!e.q.beaconParams||2!==e.q.beaconParams.Ver)&&!(!e.q.beaconParams.ti||e.ti!==e.q.beaconParams.ti))}catch(e){return!1}},this.loadConfig=function(){var t,i,o,a,n,r,s,h,c,d,p,u,l,m,g,f,v;for(s in this.uetConfig.cookieAllowed=!0,!1===e.storeConvTrackCookies&&(this.uetConfig.cookieAllowed=!1),this.uetConfig.cookieDomain="",e.hasOwnProperty("cookieDomain")&&e.cookieDomain&&"string"==typeof e.cookieDomain&&(this.uetConfig.cookieDomain=e.cookieDomain),this.uetConfig.cookieFlags="",e.hasOwnProperty("cookieFlags")&&e.cookieFlags&&"string"==typeof e.cookieFlags&&(this.uetConfig.cookieFlags=e.cookieFlags),this.uetConfig.navTimingApi=!1,!0===e.navTimingApi&&(this.uetConfig.navTimingApi=!0),this.uetConfig.errorBeaconLevel=0,e.hasOwnProperty("errorBeaconLevel")&&("number"==typeof(t=e.errorBeaconLevel)&&t%1==0&&t>=0&&t<=2&&(this.uetConfig.errorBeaconLevel=t)),this.uetConfig.disableAutoPageView=!1,!0===e.disableAutoPageView&&(this.uetConfig.disableAutoPageView=!0),this.uetConfig.disableVisibilityEvents=!1,!0===e.disableVisibilityEvents&&(this.uetConfig.disableVisibilityEvents=!0),this.uetConfig.removeQueryFromUrls=!1,!0===e.removeQueryFromUrls&&(this.uetConfig.removeQueryFromUrls=!0),this.uetConfig.allRep=!1,!0===e.allRep&&(this.uetConfig.allRep=!0),i="_uetmsdns",e.hasOwnProperty("msDnsCookie")&&e.msDnsCookie&&"string"==typeof e.msDnsCookie&&(i=e.msDnsCookie),this.uetConfig.msDns="1"===this.getCookie(i,"",1),this.uetConfig.disableUetVid=!1,!0===e.disableUetVid&&(this.uetConfig.disableUetVid=!0),this.uetConfig.vidCookie="_uetvid",this.uetConfig.uidCookie="_uetuid",e.hasOwnProperty("uidCookie")&&e.uidCookie&&"string"==typeof e.uidCookie&&(this.uetConfig.uidCookie=e.uidCookie),this.uetConfig.gtmTagSource=void 0,e.hasOwnProperty("gtmTagSource")&&e.gtmTagSource&&"string"==typeof e.gtmTagSource&&(this.uetConfig.gtmTagSource=e.gtmTagSource),this.uetConfig.gtagPid=!1,e.hasOwnProperty("pagePid")&&e.pagePid&&"object"==typeof e.pagePid?this.pageLevelParams.pid=e.pagePid:e.hasOwnProperty("gtagPid")&&!0===e.gtagPid&&(this.uetConfig.gtagPid=!0),this.uetConfig.enableAutoSpaTracking=!1,!0===e.enableAutoSpaTracking&&(this.uetConfig.enableAutoSpaTracking=!0),e.hasOwnProperty("alt")&&(this.uetConfig.imgAlt=e.alt),e.hasOwnProperty("clarityProjectId")&&e.clarityProjectId&&"string"==typeof e.clarityProjectId&&((u=document.createElement("script")).src="https://clarity.microsoft.com/js/"+e.clarityProjectId,u.type="text/javascript",u.setAttribute("crossorigin","anonymous"),u.async=1,u.onload=this.clarityOnLoad,document.head.appendChild(u)),void 0!==window.XMLHttpRequest&&"withCredentials"in new XMLHttpRequest&&(this.supportsCORS=!0),"undefined"!=typeof XDomainRequest&&(this.supportsXDR=!0),o="https:",this.uetConfig.dbgCookie="_uetdbg",a=this.getQueryParam(window.location.href,"bat_debug"),this.stringExists(a)&&(a.match(/^[0-9]{13}$/)||a.match(/^[0-9a-f]{8}-([0-9a-f]{4}-){3}[0-9a-f]{12}$/))?this.setCookie(this.uetConfig.dbgCookie,a,0,!0,!1,"",this.cookieIdMaxLength):a=this.getCookie(this.uetConfig.dbgCookie,"",this.cookieIdMaxLength),this.stringExists(a)&&(this.uetConfig.batDebug=a),n=0,1===e.Ver&&void 0!==e.advertiserId&&(n=e.advertiserId),this.postURL=o+"//"+this.domain+"/action/"+n,this.urlPrefix=this.postURL+"?",this.errPrefix=o+"//"+this.domain+"/action-err/"+n+"?",this.previewPrefix=o+"//"+this.domain+"/actionp/"+n+"?",r=1!==e.Ver?{ti:0,Ver:0,tm:1,Tag:0,EXT_Data:0}:{Ver:0,tagId:0,Tag:0,Sig:0,EXT_Data:0},e)r.hasOwnProperty(s)&&(this.beaconParams[s]=1===r[s]?encodeURIComponent(e[s]):e[s]);for(this.beaconParams.mid=this.getUuidV4(!0),h=void 0,c=0;c<5&&(h="ueto_"+this.makeRandomStr(10),window[h]);c++);this.stringExists(e.ti)&&(d=["56004448","5798164","20132024","4000835","4074038"],p=window.navigator.userLanguage||window.navigator.language,this.stringExists(p)&&0===p.indexOf("de")&&-1!==d.indexOf(e.ti)&&(this.uetConfig.deBlock=!0,this.uetConfig.cookieAllowed=!1));try{this.stringExists(h)&&!window[h]?window[h]=this.uetInstance:h=void 0}catch(u){}this.stringExists(e.ti)&&(u=document.createElement("script"),l=o+"//"+this.domain+"/p/action/"+e.ti+".js",this.stringExists(this.uetConfig.batDebug)&&(l+="?bat_debug="+this.uetConfig.batDebug),u.src=l,u.type="text/javascript",u.async=1,h&&u.setAttribute("data-ueto",h),document.head.appendChild(u)),navigator.userAgentData&&navigator.userAgentData.getHighEntropyValues&&"Windows"===navigator.userAgentData.platform&&(this.deferLoad=!0,m=this,g=setTimeout((function(){m.deferLoad=!1,m.fireSendBeacon("error",{msg:encodeURIComponent("Timeout requesting UA CH")})}),50),navigator.userAgentData.getHighEntropyValues(["platformVersion"]).then((function(e){e.hasOwnProperty("platformVersion")&&(m.uetConfig.uach={},m.uetConfig.uach.pv=encodeURIComponent(e.platformVersion)),m.deferLoad=!1,clearTimeout(g)}),(function(e){m.deferLoad=!1,clearTimeout(g),m.fireSendBeacon("error",{msg:encodeURIComponent("Error requesting UA CH: "+e)})}))),this.stringExists(this.uetConfig.batDebug)&&window.opener&&this.stringExists(e.ti)&&(f="https://ui.ads.microsoft.com",document.referrer&&window.URL&&("https:"===(v=new URL(document.referrer)).protocol&&/\.microsoft\.com$/.test(v.hostname)&&(f=v.origin)),window.opener.postMessage({type:"AckBatDbgMode",tagId:e.ti},f))},this.makeRandomStr=function(e){for(var t="",i=0;i<Math.ceil(e/2);i++)t+=this._SB(Math.floor(256*Math.random()));return t.slice(-e)},this.push=function(){var e,t,i=arguments,o=!1;if(1===i.length)if(e="event",i[0]===this.pageLoadEvt)t=[this.pageViewEvt,{}],o=!0;else{if(i[0]instanceof Array){if(!(i[0].length>0))return;i[0]=i[0][0]}t=["",i[0]||{}],o=!0}else{if(!(i.length>1&&i[0]!==this.pageLoadEvt))return;e=i[0],t=Array.prototype.slice.call(i,1)}this.uetInstance.documentLoaded||"set"===e||"consent"===e?this.uetInstance._push([e,t,o]):this.uetInstance.eventPushQueue.push([e,t,o])},this._push=function(e){var t,i,o,a,n,r,s;if(e[1]instanceof Array)if("event"===e[0]){if(t=e[1][1]||{},null==(i=e[1][0]))return;o=i===this.pageViewEvt?this.pageLoadEvt:this.customEvt,this.evt(o,i,t,e[2])}else if("set"===e[0]){if("object"!=typeof e[1][0])return;for(a in e[1][0])this.knownParams.hasOwnProperty(a)&&(this.pageLevelParams[a]=e[1][0][a])}else if("consent"===e[0]){if(this.uetConfig.consent.enabled=!0,n=e[1][1],r=e[1][0],null===n||"object"!=typeof n)return;"default"===r?(n.hasOwnProperty("ad_storage")&&!1===this.uetConfig.consent.adStorageUpdated&&(this.uetConfig.consent.adStorageAllowed="denied"!==n.ad_storage),n.hasOwnProperty("wait_for_update")&&(s=parseInt(n.wait_for_update,10),!isNaN(s)&&s>0&&(s=Math.min(s,1e4),this.uetConfig.consent.waitForUpdate=s))):"update"===r&&n.hasOwnProperty("ad_storage")&&(this.uetConfig.consent.adStorageAllowed="denied"!==n.ad_storage,this.uetConfig.consent.adStorageUpdated=!0,this.uetConfig.consent.adStorageAllowed?this.pageLoadDispatch&&this.addMsClkId(this.beaconParams):(delete this.beaconParams.sid,delete this.beaconParams.vid,delete this.beaconParams.msclkid))}},this.dispatchq=function(e){var t,i,o,a,n,r,s;for((e||(this.evqDispatch=!0,!1===this.uetConfig.disableVisibilityEvents&&"onpagehide"in window&&(window.addEventListener("pageshow",this.firePageShow.bind(this)),window.addEventListener("pagehide",this.firePageHide.bind(this))),!0===this.uetConfig.enableAutoSpaTracking&&("onpopstate"in window&&window.addEventListener("popstate",this.documentUrlChanged.bind(this,"popstate")),this.wrapHistoryMethod("pushState"),this.wrapHistoryMethod("replaceState"))),o=0);o<this.evq.length;o++)if("object"==typeof this.evq[o]){if(a=this.evq[o],"set"===t)e&&this.push(t,a);else if("consent"===t)e&&void 0!==i&&this.push(t,i,a);else if(!e)if("event"===t){for(r in n=!1,this.legacyValidCustomEventKeyNames)if(a.hasOwnProperty(r)){n=!0;break}void 0!==i&&(this.push(t,i,n?{}:a),n&&this.push(a))}else this.push(a);t=i=void 0}else"string"==typeof this.evq[o]||this.evq[o]instanceof String?(void 0!==t&&void 0!==i&&(e||this.push(t,i,{}),t=i=void 0),s=this.evq[o],void 0!==t||"set"!==s&&"consent"!==s&&"event"!==s?void 0!==t&&void 0===i?i=s:t=i=void 0:t=s,o!==this.evq.length-1||"event"!==t||e||void 0===i||this.push(t,i,{})):t=i=void 0},this.invisibleDiv=null,this.invisibleFrame=null,this._SB=function(e){return(e+256).toString(16).substring(1,3)},this._SU=function(e,t){for(var i="",o=0;o<16;o++)t&&o>=4&&o<=10&&o%2==0&&(i+="-"),i+=this._SB(e[o]);return i},this.getRandomValues=window.crypto&&window.crypto.getRandomValues&&window.crypto.getRandomValues.bind(window.crypto)||window.msCrypto&&window.msCrypto.getRandomValues&&window.msCrypto.getRandomValues.bind(window.msCrypto)||function(e){for(var t=0;t<e.length;t++)e[t]=Math.floor(256*Math.random())},this.getUuidV1=function(e){var t,i,o,a;try{for(t=new Uint8Array(10),this.getRandomValues(t),i=1e4*(Date.now()+122192928e5)+(t[8]+(t[9]<<8))%1e4,(o=new Uint8Array(16))[3]=255&i,o[2]=i>>8&255,o[1]=i>>16&255,o[0]=i>>24&255,i/=4294967296,o[5]=255&i,o[4]=i>>8&255,o[7]=i>>16&255,o[6]=i>>24&255,a=0;a<8;a++)o[a+8]=t[a];return o[8]&=63,o[8]|=128,o[6]&=15,o[6]|=16,o[10]|=1,this._SU(o,e)}catch(e){return""}},this.getUuidV4=function(e){try{var t=new Uint8Array(16);return this.getRandomValues(t),t[8]&=63,t[8]|=128,t[6]&=15,t[6]|=64,this._SU(t,e)}catch(e){return""}},this.stringifyToRequest=function(e,t){var i,o="",a="";for(i in t&&(a=t+"."),e)o+="object"==typeof e[i]?this.stringifyToRequest(e[i],a+i):a+i+"="+e[i]+"&";return o},this.createInvisibleElement=function(e,t){var i=document.createElement(t);return i.setAttribute("style","width:0px; height:0px; display:none; visibility:hidden;"),i.id="batBeacon"+Math.floor(1e12*Math.random()),e.appendChild(i),i},this.createInvisibleDiv=function(e){return this.invisibleDiv=this.createInvisibleElement(e,"div"),this.invisibleDiv.id},this.fireBeaconImg=function(e){var t,i,o=this.createInvisibleElement(this.invisibleDiv,"img");return o.width=0,o.height=0,i=e+"&rn="+(t=Math.floor(1e6*Math.random())),o.setAttribute("alt",""),this.uetConfig.imgAlt&&o.setAttribute("alt",this.uetConfig.imgAlt),o.setAttribute("src",i),t},this.addLoadTime=function(e){var t,i,o,a;if(window.performance&&(t=window.performance.timing.domContentLoadedEventEnd,window.performance.timing.loadEventEnd&&(t=window.performance.timing.loadEventEnd),void 0!==t&&0!==t&&(i=t-window.performance.timing.navigationStart,e.lt=i),this.uetConfig.navTimingApi&&null!=window.performance.timing)){var n=["navigationStart","unloadEventStart","unloadEventEnd","redirectStart","redirectEnd","fetchStart","domainLookupStart","domainLookupEnd","connectStart","connectEnd","secureConnectionStart","requestStart","responseStart","responseEnd","domLoading","domInteractive","domContentLoadedEventStart","domContentLoadedEventEnd","domComplete","loadEventStart","loadEventEnd"],r=window.performance.timing[n[0]],s=r;for(o=1;o<n.length;o++)s+=",",s+=null==(a=window.performance.timing[n[o]])||0===a?"":a-r;s.length<=150&&(e.pt=s),null!=window.performance.navigation&&(e.pn=window.performance.navigation.type+","+window.performance.navigation.redirectCount)}return e},this.hashCode=function(e){var t,i=0;if(0===e.length)return i;for(t=0;t<e.length;t++)i=(i<<5)-i+e.charCodeAt(t),i&=i;return i},this.addPluginData=function(e){for(var t,i,o,a=[],n=0;n<window.navigator.plugins.length;n++)a.push({name:window.navigator.plugins[n].name});for(t=a.sort((function(e,t){return e.name>t.name?1:e.name<t.name?-1:0})),i="",o=0;o<t.length;o++)i+=t[o].name;return e.pi=this.hashCode(i),e},this.addFraudSignals=function(e){return screen&&(screen.width&&(e.sw=screen.width),screen.height&&(e.sh=screen.height),screen.colorDepth&&(e.sc=screen.colorDepth)),navigator&&!0===navigator.webdriver&&(e.nwd="1"),e},this.addUrlData=function(e,t){var i,o,a,n,r,s,h;if(t=!0===t,i=!1,window.window!=window.top)try{for(o=0,a=window.window;o<=5&&null!=a&&a!=window.top;o++,a=a.parent)if(null!=a.document&&this.stringExists(a.document.referrer)&&"about:blank"!==a.document.referrer.toLowerCase()){r=a.document.referrer,(!0===this.uetConfig.removeQueryFromUrls||t)&&(r=r.split("?")[0]),e.p=encodeURIComponent(r),e.r="",i=!0;break}}catch(e){}return i||(n=window.document.referrer,r=window.location.href,(!0===this.uetConfig.removeQueryFromUrls||t)&&(r=r.split("?")[0],n=n.split("?")[0]),s=window.location.hash,h=r.indexOf(s)>=0?r:r+s,e.p=encodeURIComponent(h),e.r=encodeURIComponent(n)),t&&delete e.r,e},this.extractMsClkId=function(e){if(!this.stringExists(this.msClkId)){var t=e.p;try{t=decodeURIComponent(t)}catch(e){}this.msClkId=this.getQueryParam(t,this.msClkIdParamName)}},this.addPageData=function(e,t){var i,o,a;return t=!0===t,e=this.addPluginData(e),i=window.navigator.userLanguage||window.navigator.language,this.stringExists(i)&&(e.lg=i),e=this.addFraudSignals(e),o=window.document.title,this.stringExists(o)&&!this.stringExists(e.tl)&&(e.tl=encodeURIComponent(o).replace(/%2C/gi,",")),window.document.head.getElementsByTagName("meta").keywords&&(a=window.document.head.getElementsByTagName("meta").keywords.content,this.stringExists(a)&&(e.kw=encodeURIComponent(a).replace(/%2C/gi,","))),t?this.stringExists(this.previousPage)&&!e.hasOwnProperty("r")&&(e.r=this.previousPage):(e=this.addUrlData(e),e=this.addLoadTime(e)),navigator.maxTouchPoints&&(e.mtp=navigator.maxTouchPoints),e},this.removeTrailingAmp=function(e){var t=e.charAt(e.length-1);return("&"===t||"?"===t)&&(e=e.substring(0,e.length-1)),e},this.helperError=function(e){if("function"==typeof CustomEvent){var t={errMsg:e,tagId:this.beaconParams.ti},i=new CustomEvent("uetError",{detail:t});window.dispatchEvent(i)}},this.throwError=function(e){if(this.helperError(e),this.uetConfig.errorBeaconLevel>0){this.invisibleDiv||this.createInvisibleDiv(document.body);var t=this.combine(this.beaconParams,{errMsg:encodeURIComponent(e)}),i=this.stringifyToRequest(t),o=this.removeTrailingAmp(this.errPrefix+i);this.fireBeaconImg(o)}throw e},this.validateValue=function(e,t,i,o){var a=0,n=t,r=void 0===i||0===i;return-1!==t.toString().indexOf(",")&&(n=t.replace(/,/g,"")),a=parseFloat(n),(isNaN(n)||isNaN(a)||r&&-1!==a.toString().indexOf("."))&&this.throwError(e+" should be "+(r?"an integer":"a number")),a>o?this.throwError(e+" cannot be greater than "+o):a<0?this.throwError(e+" cannot be less than 0"):this.getDecimalPlaces(a)>i&&(a=parseFloat(a.toFixed(i))),a},this.validateRegex=function(e,t,i){var o=null==e?"":e.toString();return o.match(t)||this.throwError(i),o},this.encodeParameter=function(e){return(null==e?"":e.toString()).replace(/&/gi,"%26").replace(/#/gi,"%23")},this._validateProdId=function(e){return null==e&&this.throwError(this.invalidProdIdException),((e=e.toString()).length<1||e.length>50)&&this.throwError(this.invalidProdIdException),e},this.validateProdId=function(e){var t,i="";if(e instanceof Array){for(t=0;t<e.length;t++)e[t]instanceof Array&&this.throwError(this.invalidProdIdException),null!==e[t]&&void 0!==e[t]&&(i+=""!==i?",":"",i+=encodeURIComponent(this._validateProdId(e[t])));""===i&&this.throwError(this.invalidProdIdException)}else i=encodeURIComponent(this._validateProdId(e));return i},this.validatePageType=function(e,t){null==e&&this.throwError(this.invalidPageTypeException+e);var i=e.toString().toLowerCase();return t[i]||this.throwError(this.invalidPageTypeException+i),i},this.getDecimalPlaces=function(e){var t,i=parseFloat(e);return isNaN(e)||isNaN(i)?0:(t=(""+e).match(/(?:\.(\d+))?(?:[eE]([+-]?\d+))?$/))?Math.max(0,(t[1]?t[1].length:0)-(t[2]?+t[2]:0)):0},this.sha256=function e(t){function i(e,t){return e>>>t|e<<32-t}var o,a,n;try{for(var r,s,h=Math.pow,c=h(2,32),d="length",p="push",u="",l=[],m=8*t[d],g=e.h=e.h||[],f=e.k=e.k||[],v=f[d],y={},w=2;64>v;w++)if(!y[w]){for(r=0;313>r;r+=w)y[r]=w;g[v]=h(w,.5)*c|0,f[v++]=h(w,1/3)*c|0}for(t+="";t[d]%64-56;)t+="\0";for(r=0;r<t[d];r++)l[r>>2]|=t.charCodeAt(r)<<(3-r)%4*8;for(l[p](m/c|0),l[p](0|m);l[d];){for(o=l.splice(0,16),a=g,g=g.slice(0,8),r=0;64>r;r++){var _=o[r-15],C=o[r-2],P=g[0],b=g[4],k=g[7]+(i(b,6)^i(b,11)^i(b,25))+(b&g[5]^~b&g[6])+f[r]+(o[r]=16>r?o[r]:o[r-16]+(i(_,7)^i(_,18)^_>>>3)+o[r-7]+(i(C,17)^i(C,19)^C>>>10)|0);(g=[k+((i(P,2)^i(P,13)^i(P,22))+(P&g[1]^P&g[2]^g[1]&g[2]))|0].concat(g))[4]=g[4]+k|0}for(r=0;8>r;r++)g[r]=g[r]+a[r]|0}for(r=0;8>r;r++)for(s=24;s>=0;s-=8)u+=(16>(n=g[r]>>s&255)?"0":"")+n.toString(16);return u}catch(s){return""}},this.validatePid=function(e,t){var i,o;if(""===(e=e.trim().toLowerCase()))return"";if(!e.match(/^[a-z0-9]{64}$/))switch(t){case"em":case"email":if(2!=(i=e.split("@")).length){e="";break}i[0]=i[0].trim(),-1!=(o=i[0].indexOf("+"))&&(i[0]=i[0].substring(0,o)),i[0]=i[0].replace(/\./g,""),i[1]=i[1].trim(),e=i[0]+"@"+i[1],e=this.sha256(e);break;case"ph":case"phone_number":if("+"!==(e=e.replace(/[-() \t]/g,"")).charAt(0)&&(e="+"+e),!e.match(/^\+\d{11,15}$/)){e="";break}e=this.sha256(e);break;default:e=""}return e},this.validateParameter=function(e,t,i){var o,a;if(t.match(/^[a-z_]{2,32}$/)||this.throwError(e+" invalid parameter name"),null==i.type||null==this.paramValidations[i.type])return e.toString();switch((o=this.paramValidations[i.type]).type){case"regex":a=o.error.replace("{p}",t),e=this.validateRegex(e,o.regex,a);break;case"num":e=this.validateValue(t,e,o.digits,o.max);break;case"enum":""!==(e=e.toString().toLowerCase())&&-1===i.values.indexOf(e)&&this.throwError(o.error.replace("{p}",t));break;case"pid":e=e.toString(),e=this.validatePid(e,t);break;case"array":(!(e instanceof Array)||e.length<1)&&this.throwError(o.error.replace("{p}",t)),e=this.validateParameterArray(e,t);break;case"object":"object"!=typeof e?(this.helperError(o.error.replace("{p}",t)),e=""):e=this.validateParameterObject(e,t);break;default:e=e.toString()}return e},this.validateParameterObject=function(e,t){return e=this.validateSubparams(e,t+"."),this.removeTrailingAmp(this.stringifyToRequest(e))},this.validateParameterArray=function(e,t){for(var i=0;i<e.length;i++)"object"==typeof e[i]&&(e[i]=this.validateParameterObject(e[i],t));return e.join(",")},this.validateSubparams=function(e,t){var i,o,a,n={};for(i in e)if(this.knownParams.hasOwnProperty(t+i)&&null!=e[i]){if(o=this.knownParams[t+i],"string"==typeof(a=this.validateParameter(e[i],i,o))||a instanceof String){if(""===a)continue;a=encodeURIComponent(a)}n[o.hasOwnProperty("beacon")?o.beacon:i]=a}return n},this.eventBasicChecks=function(e,t){e||this.throwError(this.invalidEventException+"undefined event."),e!==this.pageLoadEvt&&e!==this.customEvt&&this.throwError(this.invalidEventException+e),t||this.throwError("undefined data object passed to validate")},this.validateDataObjectNew=function(e,t){var i,o,a,n,r;if(this.eventBasicChecks(e,t),!t.hasOwnProperty("ecomm_prodid")||null==t.ecomm_prodid||"string"==typeof t.ecomm_prodid&&""===t.ecomm_prodid.toString()||(t.ecomm_prodid=this.validateProdId(t.ecomm_prodid)),null!=(i=t.event_action)&&this.knownEvents.hasOwnProperty(i))for(a in o=this.knownEvents[i])n=o[a],this.pageLevelParams.hasOwnProperty(n)&&!t.hasOwnProperty(n)&&(t[n]=this.pageLevelParams[n]);return!(r=this.validateSubparams(t,"")).hasOwnProperty("pagetype")&&r.hasOwnProperty("prodid")&&this.throwError(this.missingPageTypeException),r.hasOwnProperty("pagetype")&&"purchase"===r.pagetype&&r.hasOwnProperty("ea")&&"purchase"===r.ea&&r.hasOwnProperty("ecomm_totalvalue")&&!r.hasOwnProperty("gv")&&(r.gv=r.ecomm_totalvalue),(r.hasOwnProperty("hct_base_price")||r.hasOwnProperty("hct_booking_xref")||r.hasOwnProperty("hct_pagetype")||r.hasOwnProperty("hct_checkin_date")||r.hasOwnProperty("hct_checkout_date")||r.hasOwnProperty("hct_length_of_stay")||r.hasOwnProperty("hct_partner_hotel_id"))&&(r.hasOwnProperty("hct_total_price")&&r.hasOwnProperty("gc")||this.throwError(this.missingHotelParametersException)),r.hasOwnProperty("hct_total_price")&&r.hasOwnProperty("gv")&&this.throwError(this.hotelVariableRevenueException),r},this.validateDataObject=function(e,t){var i,o,a,n;for(i in this.eventBasicChecks(e,t),t)e===this.customEvt&&(this.legacyValidCustomEventKeyNames[i]||this.ambiguousValidCustomEventKeyNames[i])||e===this.pageLoadEvt&&this.legacyValidPageLoadKeyNames[i]||this.throwError(this.invalidKeyException+i);t.hasOwnProperty("pid")&&(t.pid=this.validateParameter(t.pid,"pid",this.knownParams.pid),""===t.pid?delete t.pid:t.pid=encodeURIComponent(t.pid)),t.hasOwnProperty("ev")>0&&(t.ev=this.validateValue("ev",t.ev,3,999999999999)),t.hasOwnProperty("gv")>0&&(t.gv=this.validateValue("gv",t.gv,3,999999999999)),t.hasOwnProperty("gc")>0&&(t.gc=this.validateRegex(t.gc,/^[a-zA-Z]{3}$/,this.goalCurrencyFormatException)),t.hasOwnProperty("ec")>0&&null!==t.ec&&void 0!==t.ec&&(o=encodeURIComponent(t.ec),t.ec=this.encodeParameter(t.ec),t.ec!==o&&(t.ec2=o)),t.hasOwnProperty("ea")>0&&null!==t.ea&&void 0!==t.ea&&(a=encodeURIComponent(t.ea),t.ea=this.encodeParameter(t.ea),t.ea!==a&&(t.ea2=a)),t.hasOwnProperty("el")>0&&null!==t.el&&void 0!==t.el&&(n=encodeURIComponent(t.el),t.el=this.encodeParameter(t.el),t.el!==n&&(t.el2=n)),t.hasOwnProperty("ecomm_prodid")>0&&(t.prodid=t.ecomm_prodid,delete t.ecomm_prodid),t.hasOwnProperty("ecomm_pagetype")>0&&(t.pagetype=t.ecomm_pagetype,delete t.ecomm_pagetype),t.hasOwnProperty("pagetype")&&(null==t.pagetype||""===t.pagetype.toString())&&delete t.pagetype,t.hasOwnProperty("prodid")&&(null==t.prodid||"string"==typeof t.prodid&&""===t.prodid)&&delete t.prodid,t.hasOwnProperty("pagetype")>0?(t.pagetype=this.validatePageType(t.pagetype,this.validRetailPageTypeValues),t.hasOwnProperty("prodid")>0&&(t.prodid=this.validateProdId(t.prodid))):t.hasOwnProperty("prodid")>0&&this.throwError(this.missingPageTypeException)},this.evt=function(e,t,i,o){var a,n,r,s,h,c,d,p,u,l,m;if(o=!1!==o,i=i||{},!1===this.evqDispatch&&this.dispatchq(!0),!0===this.uetConfig.disableAutoPageView&&!1===this.evqDispatch&&this.dispatchq(!1),"object"==typeof i){if(!0===this.uetConfig.allRep?i.rep="1":i.hasOwnProperty("rep")&&(1===i.rep||"1"===i.rep||!0===i.rep?i.rep="1":delete i.rep),e===this.pageLoadEvt&&(!0===this.uetConfig.gtagPid&&"enhanced_conversion_data"in window&&"object"==typeof enhanced_conversion_data&&(this.pageLevelParams.pid={em:window.enhanced_conversion_data.email,ph:window.enhanced_conversion_data.phone_number}),o&&this.pageLevelParams.hasOwnProperty("pid")&&!i.hasOwnProperty("pid")&&(i.pid=this.pageLevelParams.pid)),o?this.validateDataObject(e,i):(i.event_action=t,e===this.customEvt&&i.hasOwnProperty("gtm_tag_source")&&(i=this.mapGtmParams(i)),i=this.validateDataObjectNew(e,i)),e===this.customEvt){for(n in a=[],i)a.push(n);if(0===a.length)return;o||(i.en="Y"),i=this.addUrlData(i,!0),i=this.addFraudSignals(i)}else if(e===this.pageLoadEvt){if(null!=i.ea&&this.knownEvents.hasOwnProperty(i.ea))for(s in r=this.knownEvents[i.ea],i)-1===r.indexOf(s)&&delete i[s];if(h=!o&&i.hasOwnProperty("page_path")){if(i.spa="Y",!1===this.pageLoadDispatch?(c={},c=this.addPageData(c,!1),this.stringExists(c.p)&&(this.previousPage=c.p),i.r=c.r,i.lt=c.lt,c.hasOwnProperty("pt")&&(i.pt=c.pt),c.hasOwnProperty("pn")&&(i.pn=c.pn)):(this.firePageHide(),this.beaconParams.mid=this.getUuidV4(!0)),i.hasOwnProperty("page_title")&&(i.tl=i.page_title,delete i.page_title),this.stringExists(this.previousPage)){if(-1===(p=(d=this.previousPage.toUpperCase()).indexOf("%3A%2F%2F")))return;"%2F"===i.page_path.substring(0,3).toUpperCase()?(p+=9,u=d.indexOf("%2F",p),i.p=-1===u?this.previousPage+i.page_path:this.previousPage.substring(0,u)+i.page_path):i.p=this.previousPage}}else{if(!0===this.pageLoadDispatch)return;if(!0===this.uetConfig.disableAutoPageView&&o)return;this.stringExists(this.uetConfig.gtmTagSource)&&(i.gtm_tag_source=this.uetConfig.gtmTagSource)}this.uetConfig.uach&&(l=this.stringifyToRequest(this.uetConfig.uach),l=this.removeTrailingAmp(l),l=encodeURIComponent(l),i.uach=l),!1===this.pageLoadDispatch&&(this.pageLoadDispatch=!0),i=this.addPageData(i,h),this.stringExists(i.p)&&(this.previousPage=i.p)}this.invisibleDiv||this.createInvisibleDiv(document.body),i.evt=e,window.window!=window.top&&(i.ifm=1),this.addCookieId(this.beaconParams,"sid","",this.sessionCookieName,this.sessionExpirationTime),this.addCookieId(this.beaconParams,"uid","",this.uetConfig.uidCookie,0),this.pageLevelParams.hasOwnProperty("vid")?"string"==typeof(m=this.pageLevelParams.vid)&&this.stringExists(m)&&((m=m.replace(/[-{}]/g,"").toLowerCase()).match(/^[0-9a-f]{32}$/)&&(this.beaconParams.vid=m,this.beaconParams.vids="3")):this.uetConfig.disableUetVid||this.addCookieId(this.beaconParams,"vid","vids",this.uetConfig.vidCookie,this.uetConfig.disableUetVid?0:this.visitorExpirationTime),this.addMsClkId(this.beaconParams),e===this.pageLoadEvt&&(i.sv=this.subVersion),!0===this.uetConfig.consent.enabled&&(i.asc=this.uetConfig.consent.adStorageAllowed?"G":"D"),this.stringExists(this.uetConfig.batDebug)&&(i.dbg=this.uetConfig.batDebug),!0!==this.uetConfig.msDns&&(this.fireBeacon(i),i.abf=!0),e===this.pageLoadEvt&&!1===this.evqDispatch&&this.dispatchq(!1)}},this.removeLocalStorageBackup=function(e){try{localStorage.removeItem(e+"_exp"),localStorage.removeItem(e)}catch(e){}},this.setLocalStorageBackup=function(e,t,i){try{var o=new Date;o.setTime(o.getTime()+1e3*i),localStorage.setItem(e,t),localStorage.setItem(e+"_exp",o.toUTCString())}catch(e){}},this.getLocalStorageBackup=function(e,t){var i,o;try{return null==(i=localStorage.getItem(e+"_exp"))?null:new Date>new Date(i)?(this.removeLocalStorageBackup(e),null):null==(o=localStorage.getItem(e))||o.length>t?null:o}catch(e){return null}},this.getCookie=function(e,t,i){var o,a,n,r,s;if(!this.stringExists(e)||0===(o=document.cookie).length)return null;for(this.stringExists(t)||(t=""),n=0;n<o.length;){if((a=o.indexOf(e+"="+t,n))<0)return null;if(!(a>0&&" "!==o[a-1]&&";"!==o[a-1]))break;n=a+e.length+1}return r=(r=o.indexOf(";",a))>=0?r:o.length,(s=o.substring(a+e.length+1+t.length,r)).length>i?null:s},this._setCookie=function(e,t,i,o,a){return document.cookie=e+"="+t+(i?";expires="+i.toUTCString():"")+(o?";domain=."+o:"")+";path=/"+(this.stringExists(a)?";"+a:"")},this.getHostname=function(){return document.location&&document.location.hostname},this.setCookie=function(e,t,i,o,a,n,r){var s,h,c,d,p;if(!this.stringExists(e)||(this.stringExists(n)||(n=""),!this.stringExists(t)||t.length>r))return null;if(s=null,i>0&&(s=new Date).setTime(s.getTime()+1e3*i),(h=new Date).setTime(0),a&&null!=s&&this.setLocalStorageBackup(e,t,i),null===this.domainName||o){if((c=this.getHostname())&&"string"==typeof c&&"localhost"!==c)for(p=(d=c.split(".")).pop(),3===d.length&&Number(p)>=0&&(d=[]);d.length>0;)if(p=d.pop()+"."+p,(""===this.uetConfig.cookieDomain||this.uetConfig.cookieDomain.toLowerCase()===p.toLowerCase())&&(o&&(this._setCookie(e,"",h,p,this.uetConfig.cookieFlags),o=!!this.getCookie(e,n,r)),!o&&(this._setCookie(e,n+t,s,p,this.uetConfig.cookieFlags),this.getCookie(e,n,r))))return void(this.domainName=p);this.domainName=""}this._setCookie(e,n+t,s,this.domainName,this.uetConfig.cookieFlags)},this.getQueryParam=function(e,t){return this.stringExists(e)&&this.stringExists(t)&&!/[^\d\w]/.exec(t)?(new RegExp("[?&]"+t+"=([^&#]*)","i").exec(e)||[,null])[1]:null},this.addCookieId=function(e,t,i,o,a){if(this.beaconParams.Ver<2||!1===this.uetConfig.cookieAllowed||!1===this.uetConfig.consent.adStorageAllowed)return e;var n="2",r=!0,s=this.getCookie(o,"",this.cookieIdMaxLength);return this.stringExists(s)||(r=!1,s=this.getLocalStorageBackup(o,this.cookieIdMaxLength)),0===a?(this.stringExists(s)&&(e[t]=encodeURIComponent(s),this.stringExists(i)&&(e[i]=n)),e):(this.stringExists(s)&&!s.match(/^[0-9a-f]{32}$/)&&(s=s.replace(/-/g,"")),this.stringExists(s)&&s.match(/^[0-9a-f]{32}$/)?n="0":(s=this.getUuidV1(!1),n="1"),this.setCookie(o,s,a,r,!0,"",this.cookieIdMaxLength),(this.getCookie(o,"",this.cookieIdMaxLength)===s||this.getLocalStorageBackup(o,this.cookieIdMaxLength)===s)&&(e[t]=encodeURIComponent(s),this.stringExists(i)&&(e[i]=n)),e)},this.addMsClkId=function(e){if(this.beaconParams.Ver<2||!1===this.uetConfig.cookieAllowed||!1===this.uetConfig.consent.adStorageAllowed)return e;this.extractMsClkId(this.addUrlData({}));var t="0",i=this.getCookie(this.msClkIdCookieName,this.msClkIdCookieValuePrefix,this.lengthMsClkId);return this.stringExists(i)||(i=this.getLocalStorageBackup(this.msClkIdCookieName,this.lengthMsClkId)),this.stringExists(this.msClkId)?i!==this.msClkId&&(t="1"):this.msClkId=i,this.stringExists(this.msClkId)?(this.setCookie(this.msClkIdCookieName,this.msClkId,this.msClkIdExpirationTime,!0,!0,this.msClkIdCookieValuePrefix,this.lengthMsClkId),this.getCookie(this.msClkIdCookieName,this.msClkIdCookieValuePrefix,this.lengthMsClkId)!==this.msClkId&&(t+="N"),e.msclkid=encodeURIComponent(this.msClkId+"-"+t)):e.msclkid="N",e},this.clone=function(e,t){for(var i in void 0===t&&(t={}),e)e.hasOwnProperty(i)&&(t[i]=e[i]);return t},this.combine=function(e,t){var i=this.clone(e);return i.alt&&delete i.alt,this.clone(t,i)},this.fireBeacon=function(e){for(var t,i,o=this.urlPrefix,a=this.combine(this.beaconParams,e),n=this.stringifyToRequest(a),r=this.removeTrailingAmp(o+n),s=["r","el2","ec2","ea2","page_location","page_path","kw","p","tl","items"],h=0;encodeURI(r).length>this.URLLENGTHLIMIT&&s.length>h;h++)(t=s[h])in a&&(0==h?a[t]=a[t].split("?")[0]:h<=3?a[t]="":delete a[t],n=this.stringifyToRequest(a),r=this.removeTrailingAmp(o+n));this.fireBeaconImg(r),this.snippetEventQueue.push(n),this.snippetEventQueue.length>20&&this.snippetEventQueue.shift();try{"function"==typeof CustomEvent&&(i=new CustomEvent("UetEvent",{bubbles:!0,detail:{uetEvent:n}}),this.invisibleDiv.dispatchEvent(i))}catch(e){}},this.firePageShow=function(e){!1===this.uetConfig.disableVisibilityEvents&&e&&e.persisted&&this.fireSendBeacon("pageShow")},this.firePageHide=function(){!1===this.uetConfig.disableVisibilityEvents&&this.fireSendBeacon("pageHide")},this.fireSendBeacon=function(e,t){var i,o=this.combine(this.beaconParams,{evt:e});t&&(o=this.clone(t,o)),i=this.removeTrailingAmp(this.previewPrefix+this.stringifyToRequest(o));try{navigator.sendBeacon?navigator.sendBeacon(i):this.fireBeaconImg(i)}catch(e){}},this.clarityOnLoad=function(){"undefined"!=typeof clarity&&window.clarity.start()},this.mapGtmUasProducts=function(e){var t,i,o;if(e.hasOwnProperty("ecomm_totalvalue")){if(e.ecomm_pagetype="purchase",e.ecomm_prodid=[],e.items=[],e.hasOwnProperty("transactionProducts")&&e.transactionProducts instanceof Array)for(t=0;t<e.transactionProducts.length;t++)"object"==typeof(i=e.transactionProducts[t])&&(o={},i.hasOwnProperty("sku")&&(o.id=i.sku,e.ecomm_prodid.push(o.id)),i.hasOwnProperty("price")&&(o.price=i.price),i.hasOwnProperty("quantity")&&(o.quantity=i.quantity),e.items.push(o));delete e.transactionProducts}},this.mapGtmEcommercePurchase=function(e){var t,i,o,a;if(e.hasOwnProperty("ecommerce")&&"object"==typeof e.ecommerce){if(e.ecommerce.hasOwnProperty("ecommerce")&&"object"==typeof e.ecommerce.ecommerce&&(e.ecommerce=e.ecommerce.ecommerce),e.ecommerce.hasOwnProperty("purchase")&&"object"==typeof e.ecommerce.purchase)t=e.ecommerce.purchase,e.ecomm_pagetype="purchase";else if(e.ecommerce.hasOwnProperty("add")&&"object"==typeof e.ecommerce.add)t=e.ecommerce.add,e.ecomm_pagetype="cart";else if(e.ecommerce.hasOwnProperty("click")&&"object"==typeof e.ecommerce.click)t=e.ecommerce.click,e.ecomm_pagetype="product";else if(e.ecommerce.hasOwnProperty("detail")&&"object"==typeof e.ecommerce.detail)t=e.ecommerce.detail,e.ecomm_pagetype="product";else{if(!(e.ecommerce.hasOwnProperty("impressions")&&e.ecommerce.impressions instanceof Array))return void delete e.ecommerce;t={products:e.ecommerce.impressions},e.ecomm_pagetype="other"}if(e.ecommerce.hasOwnProperty("currencyCode")&&(e.currency=e.ecommerce.currencyCode),t.hasOwnProperty("actionField")&&"object"==typeof t.actionField&&(t.actionField.hasOwnProperty("id")&&(e.transaction_id=t.actionField.id),t.actionField.hasOwnProperty("revenue")&&(e.ecomm_totalvalue=t.actionField.revenue)),t.hasOwnProperty("products")&&t.products instanceof Array)for(e.ecomm_prodid=[],e.items=[],i=0;i<t.products.length;i++)"object"==typeof(o=t.products[i])&&(a={},o.hasOwnProperty("id")&&(a.id=o.id,e.ecomm_prodid.push(a.id)),o.hasOwnProperty("price")&&(a.price=o.price),o.hasOwnProperty("quantity")&&(a.quantity=o.quantity),e.items.push(a));delete e.ecommerce}},this.mapGtmGa4Items=function(e){var t,i,o,a;if(e.hasOwnProperty("event_action"))switch(e.event_action){case"purchase":e.ecomm_pagetype="purchase";break;case"add_to_cart":e.ecomm_pagetype="cart";break;case"view_item_list":e.ecomm_pagetype="category";break;case"view_item":case"select_item":e.ecomm_pagetype="product"}if(e.hasOwnProperty("ecomm_pagetype")&&e.hasOwnProperty("event_value")&&(e.ecomm_totalvalue=e.event_value),e.hasOwnProperty("items")&&e.items instanceof Array){for(e.ecomm_prodid=[],t=[],i=0;i<e.items.length;i++)"object"==typeof(o=e.items[i])&&(a={},(o.item_id||o.id)&&(a.id=o.item_id||o.id,e.ecomm_prodid.push(a.id)),o.hasOwnProperty("price")&&(a.price=o.price),o.hasOwnProperty("quantity")&&(a.quantity=o.quantity),t.push(a));e.items=t}},this.replaceGtmParam=function(e,t,i){e.hasOwnProperty(t)&&(e[i]=e[t],delete e[t])},this.mapGtmParams=function(e){switch(e.hasOwnProperty("event_value")&&""===e.event_value&&delete e.event_value,e.gtm_tag_source){case"ua_s":this.replaceGtmParam(e,"transactionId","transaction_id"),this.replaceGtmParam(e,"transactionTotal","ecomm_totalvalue"),this.mapGtmUasProducts(e);break;case"ua_e":this.mapGtmEcommercePurchase(e);break;case"ga4":this.replaceGtmParam(e,"value","event_value"),this.mapGtmGa4Items(e)}return e};var t=window.location.href;this.documentUrlChanged=function(){var e,i=window.location.href;t!=i&&(t=i,e=window.location.pathname+window.location.search+window.location.hash,this.push("event","page_view",{page_path:e}))},this.wrapHistoryMethod=function(e){if(window.history&&window.history[e]){var t=window.history[e],i=this.documentUrlChanged.bind(this,e);window.history[e]=function(){var e=t.apply(window.history,arguments);try{i()}catch(e){}return e}}},this.trimTagId(e),this.isDuplicate(e)?(this.uetInstance=e.q,navigator.sendBeacon&&this.uetInstance.fireSendBeacon("dedup")):(this.loadConfig(),this.checkuetHostdocumentload())}function UET_init(e,t){("object"!=typeof window[e]||"[object Array]"===Object.prototype.toString.call(window[e]))&&(t.q=window[e],window[e]=new UET(t))}function UET_push(e){var t=Array.prototype.slice.call(arguments,1);window[e]=window[e]||[],window[e].push.apply(window[e],t)}